{% extends 'UMAP_App/Users/Users_base.html' %}
{% load static %}

{% block extra_css %}
<style>
    #locationSidebar {
        position: fixed;
        right: 0;
        top: 0;
        width: 24rem;
        height: 100vh;
        background-color: rgba(31, 41, 55, 0.95);
        backdrop-filter: blur(8px);
        transform: translateX(100%);
        transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        z-index: 9999;
        overflow-y: auto;
        box-shadow: -4px 0 15px rgba(0, 0, 0, 0.3);
    }

    #locationSidebar.show {
        transform: translateX(0);
    }

    .location-card {
        background-color: rgba(55, 65, 81, 0.8);
        border: 1px solid rgba(75, 85, 99, 0.3);
        border-radius: 0.75rem;
        margin-bottom: 1rem;
        overflow: hidden;
        transition: all 0.2s ease;
    }

    .location-card:hover {
        transform: translateY(-2px);
        background-color: rgba(55, 65, 81, 0.9);
        border-color: rgba(59, 130, 246, 0.5);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    .card-image {
        width: 100%;
        height: 12rem;
        object-fit: cover;
    }

    .card-content {
        padding: 1rem;
    }

    .building-description {
        color: #94a3b8;
        font-size: 0.95rem;
        line-height: 1.5;
        margin: 1rem 0;
        padding: 1rem;
        background-color: rgba(30, 41, 59, 0.5);
        border-radius: 0.5rem;
        border: 1px solid rgba(71, 85, 105, 0.3);
    }
</style>
{% endblock %}

{% block content %}
<!-- Location Details Sidebar -->
<div id="locationSidebar" class="fixed right-0 top-0 w-96 h-full overflow-y-auto transform translate-x-full transition-transform duration-300 ease-in-out z-[9999]">
    <div class="p-6">
        <!-- Header -->
        <div class="flex justify-between items-center mb-4">
            <div>
                <h2 id="buildingTitle" class="text-xl font-bold text-white mb-1">Building Information</h2>
                <p id="buildingSubtitle" class="text-sm text-blue-400"></p>
            </div>
            <button onclick="hideLocationSidebar()" class="text-gray-400 hover:text-white transition-colors p-2 hover:bg-gray-700/50 rounded-lg">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
        </div>

        <!-- Building Description -->
        <div id="buildingDescription" class="building-description"></div>
        
        <!-- Locations Section -->
        <div class="mb-4">
            <h3 class="text-lg font-semibold text-white mb-2">Accessible Locations</h3>
            <div id="locationCards" class="space-y-4">
                <!-- Location cards will be inserted here by JavaScript -->
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
// Building location data
const buildingLocations = {
    'building1': {
        title: 'Building 1',
        subtitle: 'Main Academic Building',
        description: 'A four-story building that houses various academic facilities including classrooms, laboratories, and faculty offices. Known for its modern architecture and eco-friendly design.',
        locations: [
            {
                name: 'Gymnasium',
                description: 'Multi-purpose indoor sports facility equipped with basketball courts, volleyball courts, and fitness equipment.',
                floor: '1st Floor',
                features: ['Air-conditioned', 'Viewing gallery', 'Locker rooms']
            },
            {
                name: 'Student Lounge',
                description: 'A comfortable space designed for student relaxation and collaborative study, featuring modern furniture and charging stations.',
                floor: 'Ground Floor',
                features: ['Wi-Fi enabled', 'Vending machines', 'Study booths']
            }
        ]
    },
    'building2': {
        title: 'Building 2',
        subtitle: 'Technology & Research Center',
        description: 'A state-of-the-art facility dedicated to technology and research activities. Features advanced laboratories and specialized research spaces.',
        locations: [
            {
                name: 'Computer Laboratory',
                description: 'Modern computer lab equipped with the latest hardware and software for computer science and IT studies.',
                floor: '2nd Floor',
                features: ['High-speed internet', 'Dual monitors', 'Development software']
            },
            {
                name: 'Library',
                description: 'Comprehensive library facility with extensive collection of books, journals, and digital resources.',
                floor: '1st Floor',
                features: ['Silent study areas', 'Group study rooms', 'Online catalog']
            }
        ]
    },
    'building3': {
        title: 'Building 3',
        subtitle: 'Arts & Culture Center',
        description: 'A vibrant hub for arts and cultural activities, featuring performance spaces and creative studios.',
        locations: [
            {
                name: 'Auditorium',
                description: 'Large event hall with professional sound and lighting systems, perfect for performances and ceremonies.',
                floor: 'Ground Floor',
                features: ['500+ seating capacity', 'Professional stage', 'Sound booth']
            }
        ]
    },
    'hpsb': {
        title: 'HPSB',
        subtitle: 'Human Performance & Sports Building',
        description: 'A dedicated sports complex that supports athletic development and physical education programs.',
        locations: [
            {
                name: 'Indoor Gymnasium',
                description: 'Professional-grade indoor sports facility with multiple courts and training areas.',
                floor: '1st Floor',
                features: ['Climate controlled', 'Spectator seating', 'Equipment room']
            },
            {
                name: 'Basketball Court',
                description: 'Professional outdoor basketball court with competition-standard features.',
                floor: 'Ground Floor',
                features: ['Night lighting', 'Covered bleachers', 'Water stations']
            }
        ]
    }
};

// Function to create a location card HTML
function createLocationCard(location) {
    const features = location.features ? `
        <div class="mt-3 flex flex-wrap gap-2">
            ${location.features.map(feature => `
                <span class="px-2 py-1 bg-blue-900/30 text-blue-300 text-xs rounded-full border border-blue-800/50">
                    ${feature}
                </span>
            `).join('')}
        </div>
    ` : '';

    return `
        <div class="location-card group">
            <div class="card-content">
                <div class="flex justify-between items-start mb-2">
                    <div>
                        <h3 class="text-lg font-bold text-white group-hover:text-blue-300 transition-colors">
                            ${location.name}
                        </h3>
                        <p class="text-sm text-blue-400/80">${location.floor}</p>
                    </div>
                    <button class="text-gray-400 hover:text-white p-2 hover:bg-gray-700/50 rounded-lg transition-colors">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                                  d="M9 5l7 7-7 7"/>
                        </svg>
                    </button>
                </div>
                <p class="text-gray-300 text-sm leading-relaxed">${location.description}</p>
                ${features}
            </div>
        </div>
    `;
}

// Function to show the location sidebar
window.showBuildingLocations = function(buildingId) {
    console.log('Showing locations for:', buildingId);
    const building = buildingLocations[buildingId] || {
        title: buildingId.replace(/([A-Z])/g, ' $1').trim(),
        subtitle: 'Campus Building',
        description: 'Details about this building will be updated soon.',
        locations: [{
            name: 'Main Area',
            description: 'Information about specific locations will be added shortly.',
            floor: 'All Floors',
            features: ['More details coming soon']
        }]
    };

    // Update sidebar content
    document.getElementById('buildingTitle').textContent = building.title;
    document.getElementById('buildingSubtitle').textContent = building.subtitle;
    document.getElementById('buildingDescription').textContent = building.description;

    // Clear and populate location cards
    const locationCards = document.getElementById('locationCards');
    locationCards.innerHTML = '';
    building.locations.forEach(location => {
        locationCards.innerHTML += createLocationCard(location);
    });

    // Show sidebar with animation
    const sidebar = document.getElementById('locationSidebar');
    requestAnimationFrame(() => {
        sidebar.classList.add('show');
    });
}

// Function to hide the location sidebar
window.hideLocationSidebar = function() {
    const sidebar = document.getElementById('locationSidebar');
    sidebar.classList.remove('show');
}

// Close sidebar when clicking outside
document.addEventListener('click', (e) => {
    const sidebar = document.getElementById('locationSidebar');
    const isClickInside = sidebar.contains(e.target);
    const isButtonClick = e.target.closest('[onclick*="showBuildingLocations"]');
    
    if (!isClickInside && !isButtonClick && sidebar.classList.contains('show')) {
        hideLocationSidebar();
    }
});

// Initialize tooltips for building hover effects
document.addEventListener('DOMContentLoaded', () => {
    const buildings = document.querySelectorAll('[onclick*="showBuildingLocations"]');
    buildings.forEach(building => {
        building.classList.add('cursor-pointer', 'transition-all', 'duration-200', 'hover:opacity-75');
        
        // Add hover effect
        building.addEventListener('mouseenter', () => {
            building.style.filter = 'brightness(1.2)';
        });
        
        building.addEventListener('mouseleave', () => {
            building.style.filter = '';
        });
    });
});
</script>
{% endblock %}
